(function(){function t(e,t,n){var r,i=e,s=ko.virtualElements.nextSibling(t);while(i&&(r=i)!==s)i=ko.virtualElements.nextSibling(r),n(r,i)}function n(e,n){if(e.length){var r=e[0],i=e[e.length-1],s=r.parentNode,o=ko.bindingProvider.instance,u=o.preprocessNode;if(u){t(r,i,function(e,t){var n=e.previousSibling,s=u.call(o,e);s&&(e===r&&(r=s[0]||t),e===i&&(i=s[s.length-1]||n))}),e.length=0;if(!r)return;r===i?e.push(r):(e.push(r,i),ko.utils.fixUpContinuousNodeArray(e,s))}t(r,i,function(e){(e.nodeType===1||e.nodeType===8)&&ko.applyBindings(n,e)}),t(r,i,function(e){(e.nodeType===1||e.nodeType===8)&&ko.memoization.unmemoizeDomNodeAndDescendants(e,[n])}),ko.utils.fixUpContinuousNodeArray(e,s)}}function r(e){return e.nodeType?e:e.length>0?e[0]:null}function i(t,i,s,o,u){u=u||{};var a=t&&r(t),f=(a||s||{}).ownerDocument,l=u.templateEngine||e;ko.templateRewriting.ensureTemplateIsRewritten(s,l,f);var c=l.renderTemplate(s,o,u,f);if(typeof c.length!="number"||c.length>0&&typeof c[0].nodeType!="number")throw new Error("Template engine must return an array of DOM nodes");var h=!1;switch(i){case"replaceChildren":ko.virtualElements.setDomNodeChildren(t,c),h=!0;break;case"replaceNode":ko.utils.replaceDomNodes(t,c),h=!0;break;case"ignoreTargetNode":break;default:throw new Error("Unknown renderMode: "+i)}return h&&(n(c,o),u.afterRender&&ko.dependencyDetection.ignore(u.afterRender,null,[c,o.$data])),c}function s(e,t,n){return ko.isObservable(e)?e():typeof e=="function"?e(t,n):e}function u(e,t){var n=ko.utils.domData.get(e,o);n&&typeof n.dispose=="function"&&n.dispose(),ko.utils.domData.set(e,o,t&&t.isActive()?t:undefined)}var e;ko.setTemplateEngine=function(t){if(!(t==undefined||t instanceof ko.templateEngine))throw new Error("templateEngine must inherit from ko.templateEngine");e=t},ko.renderTemplate=function(t,n,o,u,a){o=o||{};if((o["templateEngine"]||e)==undefined)throw new Error("Set a template engine before calling renderTemplate");a=a||"replaceChildren";if(u){var f=r(u),l=function(){return!f||!ko.utils.domNodeIsAttachedToDocument(f)},c=f&&a=="replaceNode"?f.parentNode:f;return ko.dependentObservable(function(){var e=n&&n instanceof ko.bindingContext?n:new ko.bindingContext(ko.utils.unwrapObservable(n)),l=s(t,e.$data,e),c=i(u,a,l,e,o);a=="replaceNode"&&(u=c,f=r(u))},null,{disposeWhen:l,disposeWhenNodeIsRemoved:c})}return ko.memoization.memoize(function(e){ko.renderTemplate(t,n,o,e,"replaceNode")})},ko.renderTemplateForEach=function(e,t,r,o,u){var a,f=function(t,n){a=u.createChildContext(t,r.as,function(e){e.$index=n});var o=s(e,t,a);return i(null,"ignoreTargetNode",o,a,r)},l=function(e,t,i){n(t,a),r.afterRender&&r.afterRender(t,e),a=null};return ko.dependentObservable(function(){var e=ko.utils.unwrapObservable(t)||[];typeof e.length=="undefined"&&(e=[e]);var n=ko.utils.arrayFilter(e,function(e){return r.includeDestroyed||e===undefined||e===null||!ko.utils.unwrapObservable(e._destroy)});ko.dependencyDetection.ignore(ko.utils.setDomNodeChildrenFromArrayMapping,null,[o,n,f,r,l])},null,{disposeWhenNodeIsRemoved:o})};var o=ko.utils.domData.nextKey();ko.bindingHandlers.template={init:function(e,t){var n=ko.utils.unwrapObservable(t());if(typeof n=="string"||n.name)ko.virtualElements.emptyNode(e);else if("nodes"in n){var r=n.nodes||[];if(ko.isObservable(r))throw new Error('The "nodes" option must be a plain, non-observable array.');var i=ko.utils.moveCleanedNodesToContainerElement(r);(new ko.templateSources.anonymousTemplate(e)).nodes(i)}else{var s=ko.virtualElements.childNodes(e),i=ko.utils.moveCleanedNodesToContainerElement(s);(new ko.templateSources.anonymousTemplate(e)).nodes(i)}return{controlsDescendantBindings:!0}},update:function(e,t,n,r,i){var s=t(),o,a=ko.utils.unwrapObservable(s),f=!0,l=null,c;typeof a=="string"?(c=s,a={}):(c=a.name,"if"in a&&(f=ko.utils.unwrapObservable(a["if"])),f&&"ifnot"in a&&(f=!ko.utils.unwrapObservable(a.ifnot)),o=ko.utils.unwrapObservable(a.data));if("foreach"in a){var h=f&&a.foreach||[];l=ko.renderTemplateForEach(c||e,h,a,e,i)}else if(!f)ko.virtualElements.emptyNode(e);else{var p="data"in a?i.createChildContext(o,a.as):i;l=ko.renderTemplate(c||e,p,a,e)}u(e,l)}},ko.expressionRewriting.bindingRewriteValidators.template=function(e){var t=ko.expressionRewriting.parseObjectLiteral(e);return t.length==1&&t[0].unknown?null:ko.expressionRewriting.keyValueArrayContainsKey(t,"name")?null:"This template engine does not support anonymous templates nested within its templates"},ko.virtualElements.allowedBindings.template=!0})(),ko.exportSymbol("setTemplateEngine",ko.setTemplateEngine),ko.exportSymbol("renderTemplate",ko.renderTemplate);